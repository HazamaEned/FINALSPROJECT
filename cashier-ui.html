<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cashier Panel</title>
    <link rel="stylesheet" href="cashier-ui.css">
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div id="sidebar">
        <div id="sidebar-header">
            <img id="apollogo" src="logomed.png" alt="apollogo">
        </div>
        <nav id="sidebar-nav">
            <a href="#" class="nav-item active">
                <img src="icons/pos.png" alt="POS" class="nav-icon">
            </a>
            <a href="cashier-transaction-history.html" class="nav-item">
                <img src="icons/history.png" alt="History" class="nav-icon">
            </a>
            <a href="settings.html" class="nav-item">
                <img src="icons/setting.png" alt="Settings" class="nav-icon">
            </a>
        </nav>
        <div id="sidebar-footer">
            <a href="login.html" class="nav-item">
                <img src="icons/power-off.png" alt="Logout" class="nav-icon">
            </a>
        </div>
    </div>

    <div id="main-content">
        <div id="topnav">
        </div>

        <div id="CashierUIContainer">
            <div id="LeftArea">
                <div id="Products" class="panel">
                    <div id="ProductSearch">Product Search</div>
                    <div id="SearchBarContainer">
                        <input type="text" id="SearchBar" placeholder="Search products...">
                    </div>
                    <div id="SortControls">
                        <button id="FilterAllBtn" class="sort-btn active" data-filter-type="all">All (A-Z)</button>
                        <button id="FilterRXBtn" class="sort-btn" data-filter-type="rx">RX</button>
                        <button id="FilterOTCBtn" class="sort-btn" data-filter-type="otc">OTC</button>
                    </div>
                    <div id="ProductGrid">
                    </div>
                </div>
            </div>

            <div id="RightArea">
                <div id="CustomerDetailsContainer" class="panel">
                    <div id="CustomerDetailsTitle">Customer Details</div>
                    <div id="CustomerDetails">
                        <div class="info">
                            <div class="info-row">
                                <span class="info-label">Customer Type:</span>
                                <span class="info-value" id="CustomerType">Regular</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">ID Number:</span>
                                <span class="info-value" id="CustomerIdNumber">N/A</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Name:</span>
                                <span class="info-value" id="CustomerName">Generic Customer</span>
                            </div>
                        </div>

                        <div id="IdImageContainer" class="IdImageContainer">
                            <div id="IdImagePreview"></div>
                            <button id="UploadIdBtn">Upload ID Image</button>
                            <button id="RemoveIdBtn" style="display: none;">Remove</button>
                            <input type="file" id="IdImageInput" accept="image/*" style="display:none;">
                        </div>

                        <div id="ScanButtonContainer">
                            <button id="ScanIdBtn">SCAN ID</button>
                        </div>

                        <div id="ApplyDiscountContainer">
                            <input type="checkbox" id="ApplyDiscount">
                            <label for="ApplyDiscount">APPLY PWD/SENIOR CITIZEN DISCOUNT</label>
                        </div>
                    </div>
                </div>

                <div id="Process" class="panel">
                    <div id="ReceiptTitle">Receipt</div>
                    <div id="ReceiptList">
                    </div>
                    <div id="ReceiptTotal">
                        Total: ₱<span id="TotalAmount">0.00</span>
                    </div>
                    <div id="ReceiptButtons">
                        <div>
                            <button id="ProcessPaymentBtn">Process Payment</button>
                            <button id="ResetReceiptBtn">Reset</button>
                        </div>
                        <button id="SendToPharmacistBtn" style="display:none;">Send to Pharmacist</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="PaymentModal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2>Payment Summary</h2>
            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 15px 0;">
            <div id="PaymentDetails">
                <p><b>Gross Subtotal:</b> ₱<span id="GrossSubtotal">0.00</span></p>
                <p><b>VATable Amount:</b> ₱<span id="VATableAmount">0.00</span></p>
                <p><b>VAT (12%):</b> ₱<span id="VATAmount">0.00</span></p>
                <div id="DiscountRow" style="display:none;">
                    <p><b>Discount (20%):</b> -₱<span id="DiscountAmount">0.00</span></p>
                </div>
            </div>
            <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 15px 0;">
            <div id="TotalDue">
                <p><b>Total Due:</b> ₱<span id="ModalTotalAmount">0.00</span></p>
            </div>

            <div class="payment-method-section">
                <h3>Select Payment Method</h3>
                <select id="PaymentMethod">
                    <option value="cash">Cash</option>
                    <option value="card">Card</option>
                    <option value="gcash">GCash</option>
                </select>
            </div>

            <div id="CashInputSection" style="display:none;">
                <label for="CashAmount"><b>Cash Given:</b></label>
                <input type="number" id="CashAmount" step="0.01" min="0" placeholder="Enter cash amount">
                <div id="ChangeDisplay"><b>Change:</b> ₱0.00</div>
            </div>

            <div class="modal-actions">
                <button id="ConfirmPaymentBtn">Confirm Payment</button>
                <button id="CancelPaymentBtn">Cancel</button>
            </div>
        </div>
    </div>

    <div id="PrintableReceipt" style="display:none;"></div>

    <script src="jquery.js"></script>
    <script src="jquery-ui-1.14.1/jquery-ui.js"></script>
<<<<<<< HEAD
<<<<<<< HEAD

<script>
        // Drug data
      const drugs = [
  { name: "Paracetamol", price: 4.24, form: "500mg Tablet", type: "otc" },
  { name: "Ibuprofen", price: 6.50, form: "200mg Tablet", type: "otc" },
  { name: "Naproxen", price: 23.00, form: "550mg Tablet", type: "otc" },
  { name: "Aspirin", price: 1.58, form: "30mg Tablet", type: "otc" },
  { name: "Aspirin", price: 2.63, form: "100mg Tablet", type: "otc" },
  { name: "Diclofenac", price: 1.84, form: "50mg Tablet", type: "rx" },
  { name: "Amlodipine", price: 6.04, form: "5mg Tablet", type: "rx" },
  { name: "Losartan", price: 4.99, form: "50mg Tablet", type: "rx" },
  { name: "Atenolol", price: 3.68, form: "50mg Tablet", type: "rx" },
  { name: "Metoprolol", price: 3.41, form: "100mg Tablet", type: "rx" },
  { name: "Enalapril", price: 5.78, form: "5mg Tablet", type: "rx" },
  { name: "Enalapril", price: 7.09, form: "10mg Tablet", type: "rx" },
  { name: "Simvastatin", price: 5.25, form: "20mg Tablet", type: "rx" },
  { name: "Atorvastatin", price: 12.08, form: "20mg Tablet", type: "rx" },
  { name: "Rosuvastatin", price: 16.80, form: "20mg Tablet", type: "rx" },
  { name: "Metformin", price: 2.10, form: "500mg Tablet", type: "rx" },
  { name: "Ganoderma Ginseng", price: 11.50, form: "400mg Capsule", type: "otc" },
  { name: "Glimepiride", price: 16.50, form: "3mg Tablet", type: "rx" },
  { name: "Clopidrogel", price: 11.55, form: "75mg Tablet", type: "rx" },
  { name: "Dexamethasone", price: 2.36, form: "500mcg Tablet", type: "rx" },
  { name: "Amoxicillin", price: 4.46, form: "500mg Capsule", type: "rx" },
  { name: "Co-amoxiclav", price: 42.00, form: "500mg/125mg Tablet", type: "rx" },
  { name: "Azithromycin", price: 122.00, form: "500mg Tablet", type: "rx" },
  { name: "Clarithromycin", price: 31.50, form: "500mg Tablet", type: "rx" },
  { name: "Levofloxacin", price: 29.66, form: "500mg Tablet", type: "rx" },
  { name: "Doxofylline", price: 19.50, form: "200mg Tablet", type: "rx" },
  { name: "Cefalexin", price: 8.93, form: "250mg Capsule", type: "rx" },
  { name: "Clindamycin", price: 9.71, form: "150mg Capsule", type: "rx" },
  { name: "Trimetazidine", price: 12.34, form: "35mg Tablet", type: "rx" },
  { name: "Metronidazole", price: 2.75, form: "500mg Tablet", type: "rx" },
  { name: "Omeprazole", price: 6.30, form: "20mg Capsule", type: "rx" },
  { name: "Esomeprazole", price: 26.25, form: "40mg Tablet", type: "rx" },
  { name: "Ranitidine", price: 3.15, form: "150mg Tablet", type: "rx" },
  { name: "Antacid", price: 4.20, form: "300mg/200mg ChewTablet", type: "otc" },
  { name: "Salbutamol", price: 49.35, form: "60ml Syrup", type: "rx" },
  { name: "Salbutamol", price: 1.84, form: "2mg Tablet", type: "rx" },
  { name: "Furesomide", price: 2.89, form: "20mg Tablet", type: "rx" },
  { name: "Fluticasone Propionate", price: 342.50, form: "0.05% 5g Cream", type: "rx" },
  { name: "Montelukast", price: 17.85, form: "5mg Tablet", type: "rx" },
  { name: "Cetirizine", price: 2.63, form: "10mg Tablet", type: "otc" },
  { name: "Loratadine", price: 5.00, form: "10mg Tablet", type: "otc" },
  { name: "Chlorpheniramine", price: 2.63, form: "5mg Tablet", type: "otc" },
  { name: "Domperidone", price: 5.51, form: "10mg Tablet", type: "rx" },
  { name: "Dextromethorphan", price: 1.75, form: "10mg Tablet", type: "otc" },
  { name: "Diazepam", price: 11.00, form: "5mg Tablet", type: "rx" },
  { name: "Fluoxetine", price: 41.25, form: "20mg Capsule", type: "rx" },
  { name: "Sertraline", price: 44.00, form: "50mg Tablet", type: "rx" },
  { name: "Hydrochlorothiazide", price: 4.90, form: "12.5mg Tablet", type: "rx" },
  { name: "Spironolactone", price: 6.50, form: "25mg Tablet", type: "rx" },
  { name: "Warfarin", price: 26.50, form: "1mg Tablet", type: "rx" },
  { name: "Ferrous sulfate", price: 2.25, form: "60mg Tablet", type: "otc" },
  { name: "Folic acid", price: 3.50, form: "5mg Capsule", type: "otc" },
  { name: "Vitamin C", price: 2.50, form: "100mg Tablet", type: "otc" },
  { name: "Multivitamin", price: 10.75, form: "Tablet", type: "otc" },
  { name: "Calcium carbonate", price: 2.75, form: "500mg Tablet", type: "otc" },
  { name: "Methylprednisolone", price: 9.00, form: "4mg Tablet", type: "rx" },
  { name: "Hydrocortisone", price: 140.00, form: "1% 5g Tube", type: "rx" },
  { name: "Mupirocin", price: 162.00, form: "2% 5g Tube", type: "rx" },
  { name: "Clotrimazole", price: 136.00, form: "1% 3.5g Tube", type: "rx" },
  { name: "Fluconazole", price: 171.75, form: "50mg Capsule", type: "rx" },
  { name: "Ketoconazole", price: 136.50, form: "2% 15g Cream", type: "rx" },
  { name: "Loperamide", price: 8.75, form: "2mg Capsule", type: "otc" },
  { name: "Oral rehydration salts", price: 16.50, form: "2.17g Sachet", type: "otc" },
  { name: "Sitagliptin", price: 19.00, form: "50mg Tablet", type: "rx" },
  { name: "Empagliflozin", price: 53.75, form: "10mg Tablet", type: "rx" },
  { name: "Allopurinol", price: 1.75, form: "100mg Tablet", type: "rx" },
  { name: "Colchicine", price: 3.50, form: "500mcg Tablet", type: "rx" },
  { name: "Chloramphenicol", price: 5.00, form: "500mg Capsule", type: "rx" },
  { name: "Tetracycline", price: 10.50, form: "500mg Capsule", type: "rx" },
  { name: "Prednisolone", price: 210.00, form: "1% 5ml Bottle", type: "rx" },
  { name: "Benzathine penicillin G", price: 259.00, form: "1.2m units Solution Vial", type: "rx" },
  { name: "Clotrimazole", price: 130.20, form: "1% 20g Cream", type: "rx" },
  { name: "Dibencozide", price: 51.25, form: "3mg Capsule", type: "rx" },
  { name: "Salicylic acid", price: 22.00, form: "10% 15ml Bottle", type: "otc" },
  { name: "Benzoyl peroxide", price: 523.50, form: "15g Bottle", type: "rx" },
  { name: "Sildenafil", price: 49.00, form: "50mg Tablet", type: "rx" },
  { name: "Tamsulosin", price: 37.01, form: "400mcg Tablet", type: "rx" },
  { name: "Finasteride", price: 27.04, form: "5mg Tablet", type: "rx" },
  { name: "Meclizine", price: 14.75, form: "25mg ChewTablet", type: "otc" },
  { name: "Potassium citrate", price: 11.00, form: "1080mg ERTablet", type: "rx" },
  { name: "Ondansetron", price: 107.00, form: "8mg Tablet", type: "rx" },
  { name: "Sodium bicarbonate", price: 200.00, form: "650mg Tablet", type: "otc" },
  { name: "Pantoprazole", price: 9.71, form: "40mg Tablet", type: "rx" },
  { name: "Mefenamic", price: 3.15, form: "500mg Tablet", type: "otc" },
  { name: "Piracetam", price: 10.50, form: "800mg Tablet", type: "rx" },
  { name: "Ibuprofen + Paracetamol", price: 10.00, form: "200mg Tablet", type: "otc" },
  { name: "Lagundi", price: 121.20, form: "600mg/5ml Bottle", type: "otc" },
  { name: "Oxymetazoline", price: 185.75, form: "10ml Bottle", type: "otc" }
];


        //CheckBox ID Function
        $(document).ready(function() {
            //Disable Button Default
            $("#UploadIdBtn").prop("disabled", true);
            $("#ScanIdBtn").prop("disabled", true);
            $(".IdImageContainer").addClass("no-hover");

            //Toggle Disable and Enable Buttons
            $("#ApplyDiscount").on("change", function(){
                const isChecked = this.checked;

                $("#ScanIdBtn").prop("disabled", !this.checked);
                $("#UploadIdBtn").prop("disabled", !this.checked);
                
                if(isChecked){
                    $(".IdImageContainer").removeClass("no-hover");
                } else{
                    $(".IdImageContainer").addClass("no-hover");
                }
            });


        });
            
        let cart = [];
        let totalAmount = 0;
=======
    <script>
        (function($) {

            const DRUGS = [
                { name: "Paracetamol", brand: "Biogesic", price: 4.24, form: "500mg Tablet", type: "otc" },
                { name: "Ibuprofen", brand: "Medicol", price: 6.50, form: "200mg Tablet", type: "otc" },
                { name: "Naproxen", brand: "Flanax Forte", price: 23.00, form: "550mg Tablet", type: "otc" },
                { name: "Aspirin", brand: "Aspen", price: 1.58, form: "30mg Tablet", type: "otc" },
                { name: "Aspirin", brand: "Aspen", price: 2.63, form: "100mg Tablet", type: "otc" },
                { name: "Diclofenac", brand: "Diclofen", price: 1.84, form: "50mg Tablet", type: "rx" },
                { name: "Amlodipine", brand: "Cardiovasc", price: 6.04, form: "5mg Tablet", type: "rx" },
                { name: "Losartan", brand: "Hypertan", price: 4.99, form: "50mg Tablet", type: "rx" },
                { name: "Atenolol", brand: "Atenol-50", price: 3.68, form: "50mg Tablet", type: "rx" },
                { name: "Metoprolol", brand: "Angimet", price: 3.41, form: "100mg Tablet", type: "rx" },
                { name: "Enalapril", brand: "Azepril", price: 5.78, form: "5mg Tablet", type: "rx" },
                { name: "Enalapril", brand: "Vazotec", price: 7.09, form: "10mg Tablet", type: "rx" },
                { name: "Simvastatin", brand: "Buztin", price: 5.25, form: "20mg Tablet", type: "rx" },
                { name: "Atorvastatin", brand: "Atorvast", price: 12.08, form: "20mg Tablet", type: "rx" },
                { name: "Rosuvastatin", brand: "Ambica", price: 16.80, form: "20mg Tablet", type: "rx" },
                { name: "Metformin", brand: "Diamet", price: 2.10, form: "500mg Tablet", type: "rx" },
                { name: "Ganoderma Ginseng", brand: "Lingzhi", price: 11.50, form: "400mg Capsule", type: "otc" },
                { name: "Glimepiride", brand: "Arya", price: 16.50, form: "3mg Tablet", type: "rx" },
                { name: "Clopidrogel", brand: "Angiogrel", price: 11.55, form: "75mg Tablet", type: "rx" },
                { name: "Dexamethasone", brand: "Medrone", price: 2.36, form: "500mcg Tablet", type: "rx" },
                { name: "Amoxicillin", brand: "Amoxil", price: 4.46, form: "500mg Capsule", type: "rx" },
                { name: "Co-amoxiclav", brand: "Augmentin", price: 42.00, form: "500mg/125mg Tablet", type: "rx" },
                { name: "Azithromycin", brand: "Zithrox", price: 122.00, form: "500mg Tablet", type: "rx" },
                { name: "Clarithromycin", brand: "Klacid", price: 31.50, form: "500mg Tablet", type: "rx" },
                { name: "Levofloxacin", brand: "Levoquin", price: 29.66, form: "500mg Tablet", type: "rx" },
                { name: "Doxofylline", brand: "Doxofyl", price: 19.50, form: "200mg Tablet", type: "rx" },
                { name: "Cefalexin", brand: "Cefalin", price: 8.93, form: "250mg Capsule", type: "rx" },
                { name: "Clindamycin", brand: "Clinda", price: 9.71, form: "150mg Capsule", type: "rx" },
                { name: "Trimetazidine", brand: "Vastarel", price: 12.34, form: "35mg Tablet", type: "rx" },
                { name: "Metronidazole", brand: "Flagyl", price: 2.75, form: "500mg Tablet", type: "rx" },
                { name: "Omeprazole", brand: "Losec", price: 6.30, form: "20mg Capsule", type: "rx" },
                { name: "Esomeprazole", brand: "Nexium", price: 26.25, form: "40mg Tablet", type: "rx" },
                { name: "Ranitidine", brand: "Zantac", price: 3.15, form: "150mg Tablet", type: "rx" },
                { name: "Antacid", brand: "Kremil-S", price: 4.20, form: "300mg/200mg ChewTablet", type: "otc" },
                { name: "Salbutamol", brand: "Ventolin", price: 49.35, form: "60ml Syrup", type: "rx" },
                { name: "Salbutamol", brand: "Ventolin", price: 1.84, form: "2mg Tablet", type: "rx" },
                { name: "Furesomide", brand: "Lasix", price: 2.89, form: "20mg Tablet", type: "rx" },
                { name: "Fluticasone P.", brand: "Flixotide", price: 342.50, form: "0.05% 5g Cream", type: "rx" },
                { name: "Montelukast", brand: "Singulair", price: 17.85, form: "5mg Tablet", type: "rx" },
                { name: "Cetirizine", brand: "Allerzine", price: 2.63, form: "10mg Tablet", type: "otc" },
                { name: "Loratadine", brand: "Claritine", price: 5.00, form: "10mg Tablet", type: "otc" },
                { name: "Chlorpheniramine", brand: "Piriton", price: 2.63, form: "5mg Tablet", type: "otc" },
                { name: "Domperidone", brand: "Motilium", price: 5.51, form: "10mg Tablet", type: "rx" },
                { name: "Dextromethorphan", brand: "Robitussin", price: 1.75, form: "10mg Tablet", type: "otc" },
                { name: "Diazepam", brand: "Valium", price: 11.00, form: "5mg Tablet", type: "rx" },
                { name: "Fluoxetine", brand: "Prozac", price: 41.25, form: "20mg Capsule", type: "rx" },
                { name: "Sertraline", brand: "Zoloft", price: 44.00, form: "50mg Tablet", type: "rx" },
                { name: "Hydrochlorothiazide", brand: "HCTZ", price: 4.90, form: "12.5mg Tablet", type: "rx" },
                { name: "Spironolactone", brand: "Aldactone", price: 6.50, form: "25mg Tablet", type: "rx" },
                { name: "Warfarin", brand: "Coumadin", price: 26.50, form: "1mg Tablet", type: "rx" },
                { name: "Ferrous sulfate", brand: "Ferlin", price: 2.25, form: "60mg Tablet", type: "otc" },
                { name: "Folic acid", brand: "Folart", price: 3.50, form: "5mg Capsule", type: "otc" },
                { name: "Vitamin C", brand: "Ascorbic", price: 2.50, form: "100mg Tablet", type: "otc" },
                { name: "Multivitamin", brand: "Centrum", price: 10.75, form: "Tablet", type: "otc" },
                { name: "Calcium carbonate", brand: "Caltrate", price: 2.75, form: "500mg Tablet", type: "otc" },
                { name: "Methylprednisolone", brand: "Medrol", price: 9.00, form: "4mg Tablet", type: "rx" },
                { name: "Hydrocortisone", brand: "Hydrotopic", price: 140.00, form: "1% 5g Tube", type: "rx" },
                { name: "Mupirocin", brand: "Mupicore", price: 162.00, form: "2% 5g Tube", type: "rx" },
                { name: "Clotrimazole", brand: "Canesten", price: 136.00, form: "1% 3.5g Tube", type: "rx" },
                { name: "Fluconazole", brand: "Mycozole", price: 171.75, form: "50mg Capsule", type: "rx" },
                { name: "Ketoconazole", brand: "Ambica", price: 136.50, form: "2% 15g Cream", type: "rx" },
                { name: "Loperamide", brand: "Diatabs", price: 8.75, form: "2mg Capsule", type: "otc" },
                { name: "Oral rehydration salts", brand: "Hydrite", price: 16.50, form: "2.17g Sachet", type: "otc" },
                { name: "Sitagliptin", brand: "Philsitz", price: 19.00, form: "50mg Tablet", type: "rx" },
                { name: "Empagliflozin", brand: "Jardiance", price: 53.75, form: "10mg Tablet", type: "rx" },
                { name: "Allopurinol", brand: "Urisol", price: 1.75, form: "100mg Tablet", type: "rx" },
                { name: "Colchicine", brand: "Goutsaph", price: 3.50, form: "500mcg Tablet", type: "rx" },
                { name: "Chloramphenicol", brand: "Zinett", price: 5.00, form: "500mg Capsule", type: "rx" },
                { name: "Tetracycline", brand: "Tricor", price: 10.50, form: "500mg Capsule", type: "rx" },
                { name: "Prednisolone", brand: "Celsus", price: 210.00, form: "1% 5ml Bottle", type: "rx" },
                { name: "Benzathine penicillin G", brand: "Zalpen", price: 259.00, form: "1.2m units Solution Vial", type: "rx" },
                { name: "Clotrimazole", brand: "Trimacort", price: 130.20, form: "1% 20g Cream", type: "rx" },
                { name: "Dibencozide", brand: "Heraclene Forte", price: 51.25, form: "3mg Capsule", type: "rx" },
                { name: "Salicylic acid", brand: "Rhea", price: 22.00, form: "10% 15ml Bottle", type: "otc" },
                { name: "Benzoyl peroxide", brand: "Benzac", price: 523.50, form: "15g Bottle", type: "rx" },
                { name: "Sildenafil", brand: "Viagra", price: 49.00, form: "50mg Tablet", type: "rx" },
                { name: "Tamsulosin", brand: "Flomax", price: 37.01, form: "400mcg Tablet", type: "rx" },
                { name: "Finasteride", brand: "Proscar", price: 27.04, form: "5mg Tablet", type: "rx" },
                { name: "Meclizine", brand: "Bonamine", price: 14.75, form: "25mg ChewTablet", type: "otc" },
                { name: "Potassium citrate", brand: "Urocit-K", price: 11.00, form: "1080mg ERTablet", type: "rx" },
                { name: "Ondansetron", brand: "Zofran", price: 107.00, form: "8mg Tablet", type: "rx" },
                { name: "Sodium bicarbonate", brand: "Neutracid", price: 200.00, form: "650mg Tablet", type: "otc" },
                { name: "Pantoprazole", brand: "Pantoloc", price: 9.71, form: "40mg Tablet", type: "rx" },
                { name: "Mefenamic", brand: "Ponstan", price: 3.15, form: "500mg Tablet", type: "otc" },
                { name: "Piracetam", brand: "Nootropil", price: 10.50, form: "800mg Tablet", type: "rx" },
                { name: "Ibuprofen + Paracetamol", brand: "Alaxan", price: 10.00, form: "200mg Tablet", type: "otc" },
                { name: "Lagundi", brand: "Ascof Forte", price: 121.20, form: "600mg/5ml Bottle", type: "otc" },
                { name: "Oxymetazoline", brand: "Drixine", price: 185.75, form: "10ml Bottle", type: "otc" },
                { name: "Cefuroxime", brand: "Zinacef", price: 16.50, form: "250mg Tablet", type: "rx" },
                { name: "Cefuroxime", brand: "Zinacef", price: 22.00, form: "500mg Tablet", type: "rx" },
                { name: "Telmisartan", brand: "Micardis", price: 28.00, form: "40mg Tablet", type: "rx" },
                { name: "Levocetirizine", brand: "Xyzal", price: 12.00, form: "5mg Tablet", type: "otc" },
                { name: "Dextrose", brand: "D5W", price: 150.00, form: "5% 500ml Solution", type: "rx" }
                ];

>>>>>>> 1dd95032803ce940b6eae36f53838b43a099a50f

=======
    <script>
        (function($) {

            const DRUGS = [
                { name: "Paracetamol", brand: "Biogesic", price: 4.24, form: "500mg Tablet", type: "otc" },
                { name: "Ibuprofen", brand: "Medicol", price: 6.50, form: "200mg Tablet", type: "otc" },
                { name: "Naproxen", brand: "Flanax Forte", price: 23.00, form: "550mg Tablet", type: "otc" },
                { name: "Aspirin", brand: "Aspen", price: 1.58, form: "30mg Tablet", type: "otc" },
                { name: "Aspirin", brand: "Aspen", price: 2.63, form: "100mg Tablet", type: "otc" },
                { name: "Diclofenac", brand: "Diclofen", price: 1.84, form: "50mg Tablet", type: "rx" },
                { name: "Amlodipine", brand: "Cardiovasc", price: 6.04, form: "5mg Tablet", type: "rx" },
                { name: "Losartan", brand: "Hypertan", price: 4.99, form: "50mg Tablet", type: "rx" },
                { name: "Atenolol", brand: "Atenol-50", price: 3.68, form: "50mg Tablet", type: "rx" },
                { name: "Metoprolol", brand: "Angimet", price: 3.41, form: "100mg Tablet", type: "rx" },
                { name: "Enalapril", brand: "Azepril", price: 5.78, form: "5mg Tablet", type: "rx" },
                { name: "Enalapril", brand: "Vazotec", price: 7.09, form: "10mg Tablet", type: "rx" },
                { name: "Simvastatin", brand: "Buztin", price: 5.25, form: "20mg Tablet", type: "rx" },
                { name: "Atorvastatin", brand: "Atorvast", price: 12.08, form: "20mg Tablet", type: "rx" },
                { name: "Rosuvastatin", brand: "Ambica", price: 16.80, form: "20mg Tablet", type: "rx" },
                { name: "Metformin", brand: "Diamet", price: 2.10, form: "500mg Tablet", type: "rx" },
                { name: "Ganoderma Ginseng", brand: "Lingzhi", price: 11.50, form: "400mg Capsule", type: "otc" },
                { name: "Glimepiride", brand: "Arya", price: 16.50, form: "3mg Tablet", type: "rx" },
                { name: "Clopidrogel", brand: "Angiogrel", price: 11.55, form: "75mg Tablet", type: "rx" },
                { name: "Dexamethasone", brand: "Medrone", price: 2.36, form: "500mcg Tablet", type: "rx" },
                { name: "Amoxicillin", brand: "Amoxil", price: 4.46, form: "500mg Capsule", type: "rx" },
                { name: "Co-amoxiclav", brand: "Augmentin", price: 42.00, form: "500mg/125mg Tablet", type: "rx" },
                { name: "Azithromycin", brand: "Zithrox", price: 122.00, form: "500mg Tablet", type: "rx" },
                { name: "Clarithromycin", brand: "Klacid", price: 31.50, form: "500mg Tablet", type: "rx" },
                { name: "Levofloxacin", brand: "Levoquin", price: 29.66, form: "500mg Tablet", type: "rx" },
                { name: "Doxofylline", brand: "Doxofyl", price: 19.50, form: "200mg Tablet", type: "rx" },
                { name: "Cefalexin", brand: "Cefalin", price: 8.93, form: "250mg Capsule", type: "rx" },
                { name: "Clindamycin", brand: "Clinda", price: 9.71, form: "150mg Capsule", type: "rx" },
                { name: "Trimetazidine", brand: "Vastarel", price: 12.34, form: "35mg Tablet", type: "rx" },
                { name: "Metronidazole", brand: "Flagyl", price: 2.75, form: "500mg Tablet", type: "rx" },
                { name: "Omeprazole", brand: "Losec", price: 6.30, form: "20mg Capsule", type: "rx" },
                { name: "Esomeprazole", brand: "Nexium", price: 26.25, form: "40mg Tablet", type: "rx" },
                { name: "Ranitidine", brand: "Zantac", price: 3.15, form: "150mg Tablet", type: "rx" },
                { name: "Antacid", brand: "Kremil-S", price: 4.20, form: "300mg/200mg ChewTablet", type: "otc" },
                { name: "Salbutamol", brand: "Ventolin", price: 49.35, form: "60ml Syrup", type: "rx" },
                { name: "Salbutamol", brand: "Ventolin", price: 1.84, form: "2mg Tablet", type: "rx" },
                { name: "Furesomide", brand: "Lasix", price: 2.89, form: "20mg Tablet", type: "rx" },
                { name: "Fluticasone P.", brand: "Flixotide", price: 342.50, form: "0.05% 5g Cream", type: "rx" },
                { name: "Montelukast", brand: "Singulair", price: 17.85, form: "5mg Tablet", type: "rx" },
                { name: "Cetirizine", brand: "Allerzine", price: 2.63, form: "10mg Tablet", type: "otc" },
                { name: "Loratadine", brand: "Claritine", price: 5.00, form: "10mg Tablet", type: "otc" },
                { name: "Chlorpheniramine", brand: "Piriton", price: 2.63, form: "5mg Tablet", type: "otc" },
                { name: "Domperidone", brand: "Motilium", price: 5.51, form: "10mg Tablet", type: "rx" },
                { name: "Dextromethorphan", brand: "Robitussin", price: 1.75, form: "10mg Tablet", type: "otc" },
                { name: "Diazepam", brand: "Valium", price: 11.00, form: "5mg Tablet", type: "rx" },
                { name: "Fluoxetine", brand: "Prozac", price: 41.25, form: "20mg Capsule", type: "rx" },
                { name: "Sertraline", brand: "Zoloft", price: 44.00, form: "50mg Tablet", type: "rx" },
                { name: "Hydrochlorothiazide", brand: "HCTZ", price: 4.90, form: "12.5mg Tablet", type: "rx" },
                { name: "Spironolactone", brand: "Aldactone", price: 6.50, form: "25mg Tablet", type: "rx" },
                { name: "Warfarin", brand: "Coumadin", price: 26.50, form: "1mg Tablet", type: "rx" },
                { name: "Ferrous sulfate", brand: "Ferlin", price: 2.25, form: "60mg Tablet", type: "otc" },
                { name: "Folic acid", brand: "Folart", price: 3.50, form: "5mg Capsule", type: "otc" },
                { name: "Vitamin C", brand: "Ascorbic", price: 2.50, form: "100mg Tablet", type: "otc" },
                { name: "Multivitamin", brand: "Centrum", price: 10.75, form: "Tablet", type: "otc" },
                { name: "Calcium carbonate", brand: "Caltrate", price: 2.75, form: "500mg Tablet", type: "otc" },
                { name: "Methylprednisolone", brand: "Medrol", price: 9.00, form: "4mg Tablet", type: "rx" },
                { name: "Hydrocortisone", brand: "Hydrotopic", price: 140.00, form: "1% 5g Tube", type: "rx" },
                { name: "Mupirocin", brand: "Mupicore", price: 162.00, form: "2% 5g Tube", type: "rx" },
                { name: "Clotrimazole", brand: "Canesten", price: 136.00, form: "1% 3.5g Tube", type: "rx" },
                { name: "Fluconazole", brand: "Mycozole", price: 171.75, form: "50mg Capsule", type: "rx" },
                { name: "Ketoconazole", brand: "Ambica", price: 136.50, form: "2% 15g Cream", type: "rx" },
                { name: "Loperamide", brand: "Diatabs", price: 8.75, form: "2mg Capsule", type: "otc" },
                { name: "Oral rehydration salts", brand: "Hydrite", price: 16.50, form: "2.17g Sachet", type: "otc" },
                { name: "Sitagliptin", brand: "Philsitz", price: 19.00, form: "50mg Tablet", type: "rx" },
                { name: "Empagliflozin", brand: "Jardiance", price: 53.75, form: "10mg Tablet", type: "rx" },
                { name: "Allopurinol", brand: "Urisol", price: 1.75, form: "100mg Tablet", type: "rx" },
                { name: "Colchicine", brand: "Goutsaph", price: 3.50, form: "500mcg Tablet", type: "rx" },
                { name: "Chloramphenicol", brand: "Zinett", price: 5.00, form: "500mg Capsule", type: "rx" },
                { name: "Tetracycline", brand: "Tricor", price: 10.50, form: "500mg Capsule", type: "rx" },
                { name: "Prednisolone", brand: "Celsus", price: 210.00, form: "1% 5ml Bottle", type: "rx" },
                { name: "Benzathine penicillin G", brand: "Zalpen", price: 259.00, form: "1.2m units Solution Vial", type: "rx" },
                { name: "Clotrimazole", brand: "Trimacort", price: 130.20, form: "1% 20g Cream", type: "rx" },
                { name: "Dibencozide", brand: "Heraclene Forte", price: 51.25, form: "3mg Capsule", type: "rx" },
                { name: "Salicylic acid", brand: "Rhea", price: 22.00, form: "10% 15ml Bottle", type: "otc" },
                { name: "Benzoyl peroxide", brand: "Benzac", price: 523.50, form: "15g Bottle", type: "rx" },
                { name: "Sildenafil", brand: "Viagra", price: 49.00, form: "50mg Tablet", type: "rx" },
                { name: "Tamsulosin", brand: "Flomax", price: 37.01, form: "400mcg Tablet", type: "rx" },
                { name: "Finasteride", brand: "Proscar", price: 27.04, form: "5mg Tablet", type: "rx" },
                { name: "Meclizine", brand: "Bonamine", price: 14.75, form: "25mg ChewTablet", type: "otc" },
                { name: "Potassium citrate", brand: "Urocit-K", price: 11.00, form: "1080mg ERTablet", type: "rx" },
                { name: "Ondansetron", brand: "Zofran", price: 107.00, form: "8mg Tablet", type: "rx" },
                { name: "Sodium bicarbonate", brand: "Neutracid", price: 200.00, form: "650mg Tablet", type: "otc" },
                { name: "Pantoprazole", brand: "Pantoloc", price: 9.71, form: "40mg Tablet", type: "rx" },
                { name: "Mefenamic", brand: "Ponstan", price: 3.15, form: "500mg Tablet", type: "otc" },
                { name: "Piracetam", brand: "Nootropil", price: 10.50, form: "800mg Tablet", type: "rx" },
                { name: "Ibuprofen + Paracetamol", brand: "Alaxan", price: 10.00, form: "200mg Tablet", type: "otc" },
                { name: "Lagundi", brand: "Ascof Forte", price: 121.20, form: "600mg/5ml Bottle", type: "otc" },
                { name: "Oxymetazoline", brand: "Drixine", price: 185.75, form: "10ml Bottle", type: "otc" },
                { name: "Cefuroxime", brand: "Zinacef", price: 16.50, form: "250mg Tablet", type: "rx" },
                { name: "Cefuroxime", brand: "Zinacef", price: 22.00, form: "500mg Tablet", type: "rx" },
                { name: "Telmisartan", brand: "Micardis", price: 28.00, form: "40mg Tablet", type: "rx" },
                { name: "Levocetirizine", brand: "Xyzal", price: 12.00, form: "5mg Tablet", type: "otc" },
                { name: "Dextrose", brand: "D5W", price: 150.00, form: "5% 500ml Solution", type: "rx" }
                ];


>>>>>>> 1dd95032803ce940b6eae36f53838b43a099a50f
            // --- NEW: Pre-process DRUGS to add a stable ID and convert brand to uppercase ---
            const MASTER_DRUGS = DRUGS.map((drug, index) => ({ 
                ...drug, 
                id: index, 
                brand: drug.brand.toUpperCase() 
            }));

            let cart = [];
            let totalAmount = 0;
            let currentFilter = 'all'; // New state variable
            
            // --- UPDATED: Function to display products, now accepts a list ---
            function displayProducts(productsToDisplay) { 
                const productGrid = $('#ProductGrid');
                productGrid.empty();
                
                // A-Z Sort
                productsToDisplay.sort((a, b) => a.name.localeCompare(b.name));

                productsToDisplay.forEach((drug) => { // Use the stable ID from now on
                    const tag = drug.type === 'rx' ? 'RX' : 'OTC';
                    const productCard = $(`
                        <div class="product-card" data-product-id="${drug.id}">
                            <div class="product-header">
                                <span class="product-type ${drug.type}">${tag}</span>
                                <span class="product-image-placeholder">
                                </span>
                            </div>
                            <div class="product-name">${drug.name}</div>
                            
                            <div class="product-brand">${drug.brand}</div>
                            
                            <div class="product-info">₱${drug.price.toFixed(2)}</div>
                            <div class="product-info">${drug.form}</div>
                            
                            <div class="product-stock">Stock: 0</div> 
                            
                        </div>
                    `);
                    
                    productCard.on('click', function() {
                        addToCart(drug); // Pass the entire drug object
                    });
                    
                    productGrid.append(productCard);
                });
            }

            // --- NEW: Function to apply filter and sort logic ---
            function applyFilter() {
                let filteredProducts = [...MASTER_DRUGS]; // Start with the master list

                // 1. Search filtering
                const searchTerm = $('#SearchBar').val().toLowerCase();
                if (searchTerm) {
                    filteredProducts = filteredProducts.filter(drug => 
                        drug.name.toLowerCase().includes(searchTerm) ||
                        drug.brand.toLowerCase().includes(searchTerm)
                    );
                }

                // 2. Type filtering
                if (currentFilter === 'rx') {
                    filteredProducts = filteredProducts.filter(drug => drug.type === 'rx');
                } else if (currentFilter === 'otc') {
                    filteredProducts = filteredProducts.filter(drug => drug.type === 'otc');
                }
                
                // 3. Display the resulting list (which includes A-Z sort)
                displayProducts(filteredProducts);
            }

            // --- REMOVED OLD filterProducts function ---

            // --- UPDATED: addToCart to use stable ID ---
            function addToCart(drug) {
                const existingItem = cart.find(item => item.id === drug.id);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        id: drug.id,
                        name: drug.name,
                        price: drug.price,
                        quantity: 1,
                        type: drug.type
                    });
                }
                
                updateReceipt();
            }

            // --- UPDATED: updateQuantity to use stable ID ---
            function updateQuantity(productId, change) {
                const item = cart.find(item => item.id === productId);
                if (item) {
                    item.quantity += change;
                    if (item.quantity <= 0) {
                        cart = cart.filter(item => item.id !== productId);
                    }
                    updateReceipt();
                }
            }
            
            function resetReceipt() {
                cart = [];
                totalAmount = 0;
                $('#CustomerType').text('Regular');
                $('#CustomerIdNumber').text('N/A');
                $('#CustomerName').text('Generic Customer');
                $('#ApplyDiscount').prop('checked', false).trigger('change');
                $('#IdImagePreview').empty();
                $('#IdImageInput').val('');
                $('#UploadIdBtn').show();
                $('#RemoveIdBtn').hide();
                updateReceipt();
            }

            function updateReceipt() {
                const receiptList = $('#ReceiptList');
                receiptList.empty();
                
                totalAmount = 0;
                let hasRx = false;
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    totalAmount += itemTotal;
                    
                    if (item.type === "rx") {
                        hasRx = true;
                    }
                    
                    const receiptItem = $(`
                        <div class="receipt-item">
                            <div class="item-name">${item.name}</div>
                            <div class="item-qty">
                                <button class="qty-btn" onclick="jQuery.updateQuantity(${item.id}, -1)">-</button>
                                <span>${item.quantity}</span>
                                <button class="qty-btn" onclick="jQuery.updateQuantity(${item.id}, 1)">+</button>
                            </div>
                            <div class="item-price">₱${itemTotal.toFixed(2)}</div>
                        </div>
                    `);
                    
                    receiptList.append(receiptItem);
                });
                
                $('#TotalAmount').text(totalAmount.toFixed(2));
                
                if (hasRx) {
                    $('#SendToPharmacistBtn').show();
                } else {
                    $('#SendToPharmacistBtn').hide();
                }
            }

            function toggleIdControls(isEnabled) {
                const controls = $('#UploadIdBtn, #ScanIdBtn');
                controls.prop("disabled", !isEnabled);
                controls.css({
                    "opacity": isEnabled ? "1" : "0.5",
                    "cursor": isEnabled ? "pointer" : "not-allowed"
                });
                // Remove button logic is handled separately by image presence
            }
            
            // Expose utility functions to the global scope for inline handlers
            $.updateQuantity = updateQuantity;
            
            // --- JQUERY READY BLOCK ---
            $(document).ready(function() {
                // START with the A-Z sort and 'all' filter applied
                applyFilter();
                updateReceipt();
                
                // --- NEW FILTERING/SORTING LOGIC HANDLER ---
                $('#SortControls').on('click', '.sort-btn', function() {
                    const $this = $(this);
                    
                    // 1. Update the filter state
                    currentFilter = $this.data('filter-type');
                    
                    // 2. Set the active button class
                    $('#SortControls .sort-btn').removeClass('active');
                    $this.addClass('active');

                    // 3. Apply the new filter/sort
                    applyFilter();
                });
                // ------------------------------------------

                // Initialize controls based on initial checkbox state
                toggleIdControls($('#ApplyDiscount').is(':checked'));

                // 🔹 LOGIC FOR PWD/SENIOR DISCOUNT CHECKBOX AND ID CONTROLS 
                $('#ApplyDiscount').on('change', function() {
                    const isChecked = $(this).is(':checked');
                    toggleIdControls(isChecked);
                    
                    if (!isChecked) {
                        // Reset customer details if discount is unchecked
                        $('#CustomerType').text('Regular');
                        $('#CustomerIdNumber').text('N/A');
                        $('#CustomerName').text('Generic Customer');
                        $('#IdImagePreview').empty();
                        $('#IdImageInput').val('');
                        $('#UploadIdBtn').show();
                        $('#RemoveIdBtn').hide();
                        alert('Discount removed. Customer details reset to Regular.');
                    }
                });

                $('#ScanIdBtn').on('click', function() {
                    if ($('#ApplyDiscount').is(':checked')) {
                        // Placeholder for successful ID scan
                        $('#CustomerType').text('Senior Citizen');
                        $('#CustomerIdNumber').text('SC-123456');
                        $('#CustomerName').text('Juan Dela Cruz');
                        alert('ID Scan successful. Customer details updated.');
                    } else {
                        alert('Error: Please check the discount box before scanning an ID.');
                    }
                });
                
                $('#UploadIdBtn').on('click', function() {
                    if ($('#ApplyDiscount').is(':checked')) {
                        $('#IdImageInput').click();
                    } else {
                        alert('Error: Please check the discount box before uploading an ID image.');
                    }
                });

                // Image change logic
                $('#IdImageInput').on('change', function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            $('#IdImagePreview').html(`<img src="${e.target.result}" style="width:100%; height:auto; border-radius:8px;">`);
                            $('#UploadIdBtn').hide();
                            $('#RemoveIdBtn').show();
                            
                            // Placeholder for successful ID details update from image scan (not implemented)
                            $('#CustomerType').text('PWD');
                            $('#CustomerIdNumber').text('PWD-654321');
                            $('#CustomerName').text('Maria Santos');
                            alert('ID Image uploaded. Customer details updated.');
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                $('#RemoveIdBtn').on('click', function() {
                    $('#IdImagePreview').empty();
                    $('#IdImageInput').val('');
                    $('#UploadIdBtn').show();
                    $('#RemoveIdBtn').hide();
                    
                    // Reset customer details on image removal
                    $('#CustomerType').text('Regular');
                    $('#CustomerIdNumber').text('N/A');
                    $('#CustomerName').text('Generic Customer');
                });
                // -----------------------------------------------------

                // --- UPDATED: Search bar now calls the main filter function ---
                $('#SearchBar').on('input', function() {
                    applyFilter();
                });

                $('#PaymentMethod').on('change', function() {
                    const method = $(this).val();
                    if (method === 'cash') {
                        $('#CashInputSection').slideDown(150);
                    } else {
                        $('#CashInputSection').slideUp(150);
                    }
                });
                
                $('#ProcessPaymentBtn').on('click', function() {
                    if (cart.length === 0) {
                        alert('Cart is empty!');
                        return;
                    }

                    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    const vat = subtotal * (12 / 112); // Assuming VAT-inclusive pricing (12% of total price is VAT)
                    const vatableAmount = subtotal - vat;
                    const hasDiscount = $('#ApplyDiscount').is(':checked');
                    const discount = hasDiscount ? subtotal * 0.20 : 0;
                    const totalDue = subtotal - discount; // The 20% discount is applied to the VAT-exclusive price (or usually total sale price) and is VAT-exempt
                    
                    // Update VAT details in modal
                    $('#GrossSubtotal').text(subtotal.toFixed(2));
                    $('#VATableAmount').text(vatableAmount.toFixed(2));
                    $('#VATAmount').text(vat.toFixed(2));
                    
                    // Update discount details in modal
                    if (hasDiscount) {
                        $('#DiscountAmount').text(discount.toFixed(2));
                        $('#DiscountRow').show();
                    } else {
                        $('#DiscountRow').hide();
                    }
                    
                    $('#ModalTotalAmount').text(totalDue.toFixed(2));
                    
                    const method = $('#PaymentMethod').val();
                    if (method === 'cash') {
                        $('#CashInputSection').show();
                    } else {
                        $('#CashInputSection').hide();
                    }
                    
                    $('#PaymentModal').css('display', 'flex').show();
                });

                $('#CashAmount').on('input', function() {
                    const cashAmount = parseFloat($(this).val()) || 0;
                    const total = parseFloat($('#ModalTotalAmount').text());
                    const change = cashAmount - total;
                    $('#ChangeDisplay').html(`<b>Change:</b> ₱${change >= 0 ? change.toFixed(2) : "0.00"}`);
                });

                $('#CancelPaymentBtn').on('click', function() {
                    $('#PaymentModal').hide();
                });

                $('#ConfirmPaymentBtn').on('click', function() {
                    const method = $('#PaymentMethod').val();
                    const methodName = { cash:"Cash", card:"Card", gcash:"GCash" }[method];
                    
                    if (cart.length === 0) {
                        alert("No items to process.");
                        return;
                    }

                    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    const vat = subtotal * (12 / 112);
                    const hasDiscount = $('#ApplyDiscount').is(':checked');
                    const discount = hasDiscount ? subtotal * 0.20 : 0;
                    const total = subtotal - discount;
                    let cashGiven = 0;

                    if (method === 'cash') {
                        cashGiven = parseFloat($('#CashAmount').val()) || 0;
                        if (cashGiven < total) {
                            alert('Insufficient cash amount!');
                            return;
                        }
                    }

                    const change = method === 'cash' ? (cashGiven - total).toFixed(2) : 0;

                    const inner = `
                        <div>
                            <h2>Apollo Pharmacy</h2>
                            <div style="text-align:center; font-size:11px;">
                                Pasig City<br>
                                Tel: (02) 1234-5678
                            </div>
                            <div class="divider"></div>
                            <div>Date: ${new Date().toLocaleString()}</div>
                            ${hasDiscount ? `<div>Customer: ${$('#CustomerName').text()} (${$('#CustomerIdNumber').text()})</div>` : ''}
                            <div class="divider"></div>

                            <table>
                                ${cart.map(item => `
                                    <tr>
                                        <td colspan="2" style="text-align:left;">${item.name}</td>
                                    </tr>
                                    <tr>
                                        <td style="text-align:left;">${item.quantity} x ₱${item.price.toFixed(2)}</td>
                                        <td style="text-align:right;">₱${(item.price * item.quantity).toFixed(2)}</td>
                                    </tr>
                                `).join('')}
                            </table>

                            <div class="divider"></div>
                            <div class="totals">
                                <div><span>Gross Subtotal:</span><span>₱${subtotal.toFixed(2)}</span></div>
                                <div><span>VATable Amount:</span><span>₱${(subtotal - vat).toFixed(2)}</span></div>
                                <div><span>VAT (12%):</span><span>₱${vat.toFixed(2)}</span></div>
                                ${hasDiscount ? `<div><span>Discount (20%):</span><span>-₱${discount.toFixed(2)}</span></div>` : ''}
                                <div><strong>Total Due:</strong><strong>₱${total.toFixed(2)}</strong></div>
                                <div><span>Payment Method:</span><span>${methodName}</span></div>
                                ${method === "cash" ? `<div><span>Cash Given:</span><span>₱${cashGiven.toFixed(2)}</span></div>
                                                    <div><span>Change:</span><span>₱${change}</span></div>` : ''}
                            </div>

                            <div class="divider"></div>
                            <div class="footer">
                                <div>Served by: Cashier Name</div>
                                <div>Thank you for your purchase!</div>
                                <div>***************</div>
                            </div>
                        </div>
                    `;

                    $('#PrintableReceipt').html(inner);
                    $('#PaymentModal').hide();

                    setTimeout(function(){
                        window.print();
                        $('#PrintableReceipt').empty();
                        resetReceipt();
                        alert(`Payment confirmed via ${methodName}. Thank you!`);
                    }, 250);
                });

                $('#ResetReceiptBtn').on('click', function() {
                    if (cart.length === 0 && $('#ApplyDiscount').is(':checked')) {
                        resetReceipt();
                        alert('Discount application and customer details reset.');
                        return;
                    }
                    if (cart.length === 0) {
                        alert('No items or active discount to reset.');
                        return;
                    }
                    if (confirm("Clear the current receipt and reset customer details?")) {
                        resetReceipt();
                    }
                });
                
                $('#SendToPharmacistBtn').on('click', function() {
                    alert('Order sent to Pharmacist for review/approval.');
                });
            });

        })(jQuery);
    </script>
</body>
</html>